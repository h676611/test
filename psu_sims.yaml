spec: "1.0"

devices:
  HMP4040:
    eom:
      ASRL INSTR:
        q: "\r\n"
        r: "\n"
    error: "DUMMY ERROR"
    dialogues:
      - q: "*IDN?"
        r: "Rohde&Schwarz,HMP4040,DUMMY,SIM"
      - q: "SYST:LOC"
        r: "OK"
      - q: "SYST:REM"
        r: "OK"
      - q: "SYST:MIX"
        r: "OK"
      - q: "SYST:ERR?"
        r: "ERROR 0,No error"
      - q: "OUTP?"
        r: "{output_state}"
      - q: "OUTP:SEL 1"
        r: "OK"
      - q: "OUTP:SEL 0"
        r: "OK"
      - q: "OUTP:GEN 1"
        r: "OK"
      - q: "OUTP:GEN 0"
        r: "OK"
    properties:
      channel:
    getter:
      q: "INST:NSEL?"
      r: "{:d}"
    setter:
      q: "INST OUT {:d}"
    specs:
      min: 1
      max: 4
      type: int

  voltage:
    getter:
      q: "VOLT?" # Returns the set value
      r: "{:f}"
    setter:
      q: "VOLT {:f}"
    specs:
      type: float

  current:
    getter:
      q: "CURR?" # Returns the set value
      r: "{:f}"
    setter:
      q: "CURR {:f}"
    specs:
      type: float

  meas_voltage:
    getter:
      q: "MEAS:VOLT?" # Actual measured output
      r: "{:f}"

  meas_current:
    getter:
      q: "MEAS:CURR?" # Actual measured output
      r: "{:f}"

  voltage_limit:
    getter:
      q: "CURR VLIM?"
      r: "{:f}"
    setter:
      q: "CURR VLIM {:f}"

  current_limit:
    getter:
      q: "VOLT ILIM?"
      r: "{:f}"
    setter:
      q: "VOLT ILIM {:f}"

  output_enabled:
    getter:
      q: "OUTP:SEL?"
      r: "{:d}"
    setter:
      q: "OUTP {:d}"
    specs:
      type: bool

  output_all:
    setter:
      q: "OUTP:GEN {:d}"
    specs:
      type: bool

  source_function:
    setter:
      q: "SOUR FUNC {:s}"

  remote_mode:
    setter:
      q: "SYST:{:s}"
    specs:
      options:
        local: "LOC"
        remote: "REM"
        mixed: "MIX"

resources:
  ASRL1::INSTR:
    device: HMP4040
  ASRL2::INSTR:
    device: HMP4040
